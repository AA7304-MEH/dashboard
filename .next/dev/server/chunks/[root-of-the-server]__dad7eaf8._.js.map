{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///D:/linkedin%20content%20generator/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///D:/linkedin%20content%20generator/app/api/analyze-hook/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { GoogleGenerativeAI } from '@google/generative-ai';\r\nimport { auth, currentUser } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nconst genAI = new GoogleGenerativeAI(process.env.GOOGLE_GENERATIVE_AI_API_KEY || '');\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { hook } = await request.json();\r\n        const { userId } = await auth();\r\n\r\n        if (!hook) {\r\n            return NextResponse.json({ error: 'Hook text is required' }, { status: 400 });\r\n        }\r\n\r\n        const model = genAI.getGenerativeModel({ model: \"gemini-2.0-flash\" });\r\n\r\n        const prompt = `Analyze this LinkedIn post opening line (hook): \"${hook}\"\r\n\r\n    Return a JSON object with the following structure (do not include markdown formatting):\r\n    {\r\n      \"score\": number (1-10),\r\n      \"color\": \"green\" | \"yellow\" | \"red\",\r\n      \"badges\": [\"string (e.g., Curiosity gap detected, Emotional trigger present, Question fatigue warning, Generic opening detected)\"],\r\n      \"feedback\": \"string (Why this score?)\",\r\n      \"alternatives\": [\"string (Alternative hook 1)\", \"string (Alternative hook 2)\", \"string (Alternative hook 3)\"]\r\n    }\r\n\r\n    Scoring criteria:\r\n    - 8-10 (Green): High curiosity, strong emotion, or specific benefit.\r\n    - 5-7 (Yellow): Good but could be sharper.\r\n    - 1-4 (Red): Generic, boring, or too long.`;\r\n\r\n        const result = await model.generateContent(prompt);\r\n        const response = await result.response;\r\n        let text = response.text();\r\n\r\n        // Clean up markdown code blocks if present\r\n        text = text.replace(/```json/g, '').replace(/```/g, '').trim();\r\n\r\n        const analysis = JSON.parse(text);\r\n\r\n        // Save to DB if logged in\r\n        if (userId) {\r\n            await prisma.user.upsert({\r\n                where: { id: userId },\r\n                update: {},\r\n                create: { id: userId, email: (await currentUser())?.emailAddresses[0]?.emailAddress || 'unknown' },\r\n            });\r\n\r\n            await prisma.hookAnalysis.create({\r\n                data: {\r\n                    hookText: hook,\r\n                    score: analysis.score,\r\n                    feedback: JSON.stringify(analysis),\r\n                    userId: userId,\r\n                },\r\n            });\r\n        }\r\n\r\n        return NextResponse.json(analysis);\r\n    } catch (error) {\r\n        console.error(\"Hook analysis error:\", error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to analyze hook' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AACA;;;;;AAEA,MAAM,QAAQ,IAAI,sLAAkB,CAAC,+EAA4C;AAE1E,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QACnC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,6LAAI;QAE7B,IAAI,CAAC,MAAM;YACP,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QAEnE,MAAM,SAAS,CAAC,iDAAiD,EAAE,KAAK;;;;;;;;;;;;;;8CAclC,CAAC;QAEvC,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,IAAI,OAAO,SAAS,IAAI;QAExB,2CAA2C;QAC3C,OAAO,KAAK,OAAO,CAAC,YAAY,IAAI,OAAO,CAAC,QAAQ,IAAI,IAAI;QAE5D,MAAM,WAAW,KAAK,KAAK,CAAC;QAE5B,0BAA0B;QAC1B,IAAI,QAAQ;YACR,MAAM,yHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACrB,OAAO;oBAAE,IAAI;gBAAO;gBACpB,QAAQ,CAAC;gBACT,QAAQ;oBAAE,IAAI;oBAAQ,OAAO,CAAC,MAAM,IAAA,2MAAW,GAAE,GAAG,cAAc,CAAC,EAAE,EAAE,gBAAgB;gBAAU;YACrG;YAEA,MAAM,yHAAM,CAAC,YAAY,CAAC,MAAM,CAAC;gBAC7B,MAAM;oBACF,UAAU;oBACV,OAAO,SAAS,KAAK;oBACrB,UAAU,KAAK,SAAS,CAAC;oBACzB,QAAQ;gBACZ;YACJ;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}